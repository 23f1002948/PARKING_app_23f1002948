{% extends "index.html" %} {% block title %}Admin dashboard{% endblock %} {%
block content %}
<div class="container my-5">
  <h2 class="mb-4">User Dashboard</h2>
   

  <!-- Recent Parking History (Collapsible) -->
  <div class="accordion mb-4" id="historyAccordion">
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingHistory">
        <button
          class="accordion-button"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#collapseHistory"
          aria-expanded="true"
          aria-controls="collapseHistory"
        >
          Recent Parking History
        </button>
      </h2>
      <div
        id="collapseHistory"
        class="accordion-collapse collapse show"
        aria-labelledby="headingHistory"
        data-bs-parent="#historyAccordion"
      >
        <div class="accordion-body">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Location</th>
                <th>Vehicle No</th>
                <th>Parking Time</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              {% for r in reservations %}
              <tr>
                <td>{{ r.spot.lot.prime_location_name }}</td>
                <td>{{ r.vehicle_number if r.vehicle_number else '-' }}</td>
                <td>{{ r.parking_timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>
                  {% if not r.leaving_timestamp %}
                  <form
                    method="POST"
                    action="{{ url_for('main.release_spot', reservation_id=r.id) }}"
                    style="display: inline"
                  >
                    <button class="btn btn-outline-danger btn-sm" type="submit">
                      Release
                    </button>
                  </form>
                  {% else %}
                  <span class="text-success">parking out</span>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Search Parking Form -->
  <form class="mb-4" method="GET" action="">
    <div class="input-group">
      <input
        type="text"
        class="form-control"
        name="search"
        placeholder="Search parking @location/zip code"
        aria-label="Search parking"
      />
      <button class="btn btn-outline-primary" type="submit">Search</button>
    </div>
  </form>

  <!-- Parking Lots (Collapsible) -->
  {% include "user_dashboard/parking_lot.html" %}  
 
</div>
<!-- Release Modal -->
<!-- Release Modal for Spot 136 -->
{% include "user_dashboard/releasing_modals.html" %}

<!-- Book Parking Spot Modal for Spot 136 (example) -->
{% for lot in lots %}
<!-- ...your lot card/table code... -->

{% include "user_dashboard/parking_modals.html" %} 

{% endfor %}
<!-- Book Parking History (example) -->

{% endblock %}